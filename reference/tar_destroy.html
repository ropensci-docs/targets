<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Destroy the data store. — tar_destroy • targets</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Destroy the data store. — tar_destroy"><meta name="description" content="Destroy the data store written by the pipeline."><meta property="og:description" content="Destroy the data store written by the pipeline."><meta property="og:image" content="https://docs.ropensci.org/targets/logo.svg"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">targets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8.0.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/overview.html">Overview</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://books.ropensci.org/targets">Manual</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://books.ropensci.org/targets-design">Design</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/overview.html">An overview of targets</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/targets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Destroy the data store.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/targets/blob/master/R/tar_destroy.R" class="external-link"><code>R/tar_destroy.R</code></a></small>
      <div class="d-none name"><code>tar_destroy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Destroy the data store written by the pipeline.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tar_destroy</span><span class="op">(</span></span>
<span>  destroy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"cloud"</span>, <span class="st">"local"</span>, <span class="st">"meta"</span>, <span class="st">"process"</span>, <span class="st">"progress"</span>, <span class="st">"objects"</span>,</span>
<span>    <span class="st">"scratch"</span>, <span class="st">"workspaces"</span>, <span class="st">"user"</span><span class="op">)</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  script <span class="op">=</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="tar_config_get.html">tar_config_get</a></span><span class="op">(</span><span class="st">"script"</span><span class="op">)</span>,</span>
<span>  store <span class="op">=</span> <span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="tar_config_get.html">tar_config_get</a></span><span class="op">(</span><span class="st">"store"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-destroy">destroy<a class="anchor" aria-label="anchor" href="#arg-destroy"></a></dt>
<dd><p>Character of length 1, what to destroy. Choices:</p><ul><li><p><code>"all"</code>: entire data store (default: <code>_targets/</code>)
including cloud data, as well as download/upload scratch files.</p></li>
<li><p><code>"cloud"</code>: cloud data, including metadata as well as target object data
from targets with <code>tar_target(..., repository = "aws")</code>.
Also deletes temporary staging files in
<code>file.path(tempdir(), "targets")</code>
that may have been accidentally left over from incomplete
uploads or downloads.</p></li>
<li><p><code>"local"</code>: all the local files in the data store but nothing
on the cloud.</p></li>
<li><p><code>"meta"</code>: metadata file at <code>meta/meta</code> in the
data store, which invalidates all the targets but keeps the data.</p></li>
<li><p><code>"process"</code>: progress data file at
<code>meta/process</code> in the data store, which resets the metadata
of the main process.</p></li>
<li><p><code>"progress"</code>: progress data file at
<code>meta/progress</code> in the data store,
which resets the progress tracking info.</p></li>
<li><p><code>"objects"</code>: all the target
return values in <code>objects/</code> in the data
store but keep progress and metadata.
Dynamic files are not deleted this way.</p></li>
<li><p><code>"scratch"</code>: temporary files in saved during <code><a href="tar_make.html">tar_make()</a></code> that should
automatically get deleted except if R crashed.</p></li>
<li><p><code>"workspaces"</code>: compressed lightweight files in <code>workspaces/</code>
in the data store with the saved workspaces of targets.
See <code><a href="tar_workspace.html">tar_workspace()</a></code> for details.</p></li>
<li><p><code>"user"</code>: custom user-supplied files in the <code>user/</code> folder in the
data store.</p></li>
</ul></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>Positive integer between 1 and 1000,
number of target objects to delete
from the cloud with each HTTP API request.
Currently only supported for AWS.
Cannot be more than 1000.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical of length 1, whether to print console messages
to show progress when deleting each batch of targets from each
cloud bucket. Batched deletion with verbosity is currently only supported
for AWS.</p></dd>


<dt id="arg-ask">ask<a class="anchor" aria-label="anchor" href="#arg-ask"></a></dt>
<dd><p>Logical of length 1, whether to pause with a menu prompt
before deleting files. To disable this menu, set the <code>TAR_ASK</code>
environment variable to <code>"false"</code>. <code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>
can help set environment variables.</p></dd>


<dt id="arg-script">script<a class="anchor" aria-label="anchor" href="#arg-script"></a></dt>
<dd><p>Character of length 1, path to the
target script file. Defaults to <code>tar_config_get("script")</code>,
which in turn defaults to <code>_targets.R</code>. If the script does not exist,
then cloud metadata will not be deleted.</p></dd>


<dt id="arg-store">store<a class="anchor" aria-label="anchor" href="#arg-store"></a></dt>
<dd><p>Character of length 1, path to the
<code>targets</code> data store. Defaults to <code>tar_config_get("store")</code>,
which in turn defaults to <code>_targets/</code>.
When you set this argument, the value of <code>tar_config_get("store")</code>
is temporarily changed for the current function call.
See <code><a href="tar_config_get.html">tar_config_get()</a></code> and <code><a href="tar_config_set.html">tar_config_set()</a></code> for details
about how to set the data store path persistently
for a project.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>NULL</code> (invisibly).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The data store is a folder created by <code><a href="tar_make.html">tar_make()</a></code>
(or <code><a href="tar_make_future.html">tar_make_future()</a></code> or <code><a href="tar_make_clustermq.html">tar_make_clustermq()</a></code>).
The details of the data store are explained at
<a href="https://books.ropensci.org/targets/data.html#local-data-store" class="external-link">https://books.ropensci.org/targets/data.html#local-data-store</a>.
The data store folder contains the output data
and metadata of the targets in the pipeline. Usually,
the data store is a folder called <code>_targets/</code>
(see <code><a href="tar_config_set.html">tar_config_set()</a></code> to customize), and it may
link to data on the cloud if you used AWS or GCP
buckets. By default, <code>tar_destroy()</code> deletes the entire
<code>_targets/</code> folder (or wherever the data store is located),
including custom user-supplied files in <code>_targets/user/</code>,
as well as any cloud data that the pipeline uploaded.
See the <code>destroy</code> argument to customize this behavior
and only delete part of the data store, and see functions like
<code><a href="tar_invalidate.html">tar_invalidate()</a></code>, <code><a href="tar_delete.html">tar_delete()</a></code>, and <code><a href="tar_prune.html">tar_prune()</a></code> to remove
information pertaining to some but not all targets in the pipeline.
After calling <code>tar_destroy()</code> with default arguments,
the entire data store is gone, which means all the output data from
previous runs of the pipeline is gone (except for
input/output files tracked with <code>tar_target(..., format = "file")</code>).
The next run of the pipeline will start from scratch,
and it will not skip any targets.</p>
    </div>
    <div class="section level2">
    <h2 id="storage-access">Storage access<a class="anchor" aria-label="anchor" href="#storage-access"></a></h2>


<p>Several functions like <code><a href="tar_make.html">tar_make()</a></code>, <code><a href="tar_read.html">tar_read()</a></code>, <code><a href="tar_load.html">tar_load()</a></code>,
<code><a href="tar_meta.html">tar_meta()</a></code>, and <code><a href="tar_progress.html">tar_progress()</a></code> read or modify
the local data store of the pipeline.
The local data store is in flux while a pipeline is running,
and depending on how distributed computing or cloud computing is set up,
not all targets can even reach it. So please do not call these
functions from inside a target as part of a running
pipeline. The only exception is literate programming
target factories in the <code>tarchetypes</code> package such as <code><a href="https://docs.ropensci.org/tarchetypes/reference/tar_render.html" class="external-link">tar_render()</a></code>
and <code><a href="https://docs.ropensci.org/tarchetypes/reference/tar_quarto.html" class="external-link">tar_quarto()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="cloud-target-data-versioning">Cloud target data versioning<a class="anchor" aria-label="anchor" href="#cloud-target-data-versioning"></a></h2>


<p>Some buckets in Amazon S3 or Google Cloud Storage are "versioned",
which means they track historical versions of each data object.
If you use <code>targets</code> with cloud storage
(<a href="https://books.ropensci.org/targets/cloud-storage.html" class="external-link">https://books.ropensci.org/targets/cloud-storage.html</a>)
and versioning is turned on, then <code>targets</code> will record each
version of each target in its metadata.</p>
<p>Functions like <code><a href="tar_read.html">tar_read()</a></code>
and <code><a href="tar_load.html">tar_load()</a></code> load the version recorded in the local metadata,
which may not be the same as the "current" version of the
object in the bucket. Likewise, functions <code><a href="tar_delete.html">tar_delete()</a></code>
and <code>tar_destroy()</code> only remove
the version ID of each target as recorded in the local
metadata.</p>
<p>If you want to interact with the <em>latest</em> version of an object
instead of the version ID recorded in the local metadata,
then you will need to delete the object from the metadata.</p><ol><li><p>Make sure your local copy of the metadata is current and
up to date. You may need to run <code><a href="tar_meta_download.html">tar_meta_download()</a></code> or
<code><a href="tar_meta_sync.html">tar_meta_sync()</a></code> first.</p></li>
<li><p>Run <code><a href="tar_unversion.html">tar_unversion()</a></code> to remove the recorded version IDs of
your targets in the local metadata.</p></li>
<li><p>With the version IDs gone from the local metadata,
functions like <code><a href="tar_read.html">tar_read()</a></code> and <code>tar_destroy()</code> will use the
<em>latest</em> version of each target data object.</p></li>
<li><p>Optional: to back up the local metadata file with the version IDs
deleted, use <code><a href="tar_meta_upload.html">tar_meta_upload()</a></code>.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other clean:
<code><a href="tar_delete.html">tar_delete</a>()</code>,
<code><a href="tar_invalidate.html">tar_invalidate</a>()</code>,
<code><a href="tar_prune.html">tar_prune</a>()</code>,
<code><a href="tar_prune_list.html">tar_prune_list</a>()</code>,
<code><a href="tar_unversion.html">tar_unversion</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"TAR_EXAMPLES"</span><span class="op">)</span>, <span class="st">"true"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># for CRAN</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tar_dir.html">tar_dir</a></span><span class="op">(</span><span class="op">{</span> <span class="co"># tar_dir() runs code from a temp dir for CRAN.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tar_script.html">tar_script</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/" class="external-link">tarchetypes</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="tar_target.html">tar_target</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tar_make.html">tar_make</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Creates the _targets/ data store.</span></span></span>
<span class="r-in"><span><span class="fu">tar_destroy</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"_targets"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Should be FALSE.</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

